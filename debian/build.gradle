plugins {
  id "nebula.ospackage" version "4.5.1"
}

configurations {
    generateDeb
}

dependencies {
    generateDeb project( ':utc-server' )
}

// See https://github.com/nebula-plugins/gradle-ospackage-plugin/wiki/Deb-Plugin
task generateDeb(type: Deb) {
    packageName = 'utc'
    release = '1'
    user = 'utc'

    preInstall file('debianPreInstall.sh')
    postInstall file('debianPostInstall.sh')
    
    into '/opt/utc'
    from( '../bin' ) {
        exclude 'tmp'
    }
    from '../sqlite/utc.sqlite.empty.db'

    from( 'utc-server.service' ) {
        into '/lib/systemd/system'
    }

}

build.dependsOn 'generateDeb'
generateDeb.dependsOn ':utc-server:war'
